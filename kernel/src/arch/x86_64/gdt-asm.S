/*
 *  GDT and TSS flushing assembly
 */

.global lgdt

lgdt:
    lgdt    (%rdi)
    mov     $0x10, %ax
    mov     %ax, %ds
    mov     %ax, %es
    mov     %ax, %fs
    mov     %ax, %gs
    mov     %ax, %ss
    pop     %rdi
    mov     $0x08, %rax
    pushq   %rax
    pushq   %rdi
    retfq

.global ltr
ltr:
    mov     %rdi, %rax
    ltr     %ax
    ret
